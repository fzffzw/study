find用法

find -iname不区分大小写
find -size + 表示大于某个字节 - 表示小于某个字节
find -cmin 访问时间
     -amin 文件属性
     -mmim 文件内容
例如 find /etc -cmin -5 表示五分钟之内文件属性被修改过

-a 表示 and 连接字符（两个条件必须都满足）
-o 标示 or (两个条件满足一个即可)
-type 根据文件类型查找
	f 文件 d 目录 l 软链接文件、
例如 find /etc/ -name init* -a -type d

查找某个文件夹下的包含某个字符的文件
find /usr/local/src/mysql-5.5.28 -type f -name "*.*" | xargs grep "Too many connections"


对find 结果做操作
find / -name inittab -exec ls -l {} \;
可以用 -exec/-ok 命令 {} \; 对搜索结果执行操作
{} 标示find 查找的结果 \ 转义符号 
其中-ok标示询问确认

-inum 
find . -inum *** -exec rm {} \;

find . -inum 787476 -exec mv {} gitstudy.txt \;
修改乱码文件名称


用find 可以查找任何文件的硬连接


查找某个文件夹下的包含某个字符的文件
find /usr/local/src/mysql-5.5.28 -type f -name "*.*" | xargs grep "Too many connections"

locate 用法
locate inittab
查找inittab所在的位置

updatedb 更新文件资料库

which 
查找命令所在的目录

whereis
找到文件命令的绝对路径和帮助文档

文件内容搜索
例如 grep multiuser /etc/inittab

find / -name 'httpd.conf' -exec ls -l {} and -exec grep Listen {} \;

grep -v 排除指定字符
cat /usr/local/apache2/conf/httpd.conf | grep -v ^# |grep -v ^[\s]+#



##############文件搜索与帮助命令###################


man php 查看php配置文件




###############用户相关#############################
useradd
创建用户

passwd
设置密码


#############网络命令###################################
write
给用户发消息

wall "message"
给所有用户都发消息

ping
-c n ping的次数

ifconfig

mail
邮件部分
h 查看列表
1 查看第一封邮件
d 1 删除第一封邮件


last
##查询所有用户所有登陆信息
登陆用户  终端        来源ip		登陆时间	  状态（如下 还在登陆）
root     pts/1        192.168.0.105    Sun Nov 16 20:42   still logged in
 

lastlog
##查看用户最后一次登陆信息
lastlog -u uid (只看该uid用户的登陆信息)

traceroute
##探测到达某个主机的信息（跟踪路由）

netstat
##显示网络相关服务
选项如下
-t TCP协议
-u UDP协议
-l 监听
-r 路由
-n 显示ip地址和端口号

例如
netstat -tlun 查看本机监听的端口
netstat -an 查看本机所有的网络连接
netstat -rn 查看本机路由表


/etc/service里面定义服务
tcp 三次握手 
udp 不握手

tcp 传送控制协议(面向连接) （类似打电话）
udp 用户数据报谢谢 （类似发短信）


例子
netstat -tlun
协议  接收队列书 发送队列数 ip和端口（服务器端口） 		
Proto Recv-Q Send-Q Local Address               Foreign Address             State      
tcp        0      0 127.0.0.1:2208              0.0.0.0:*                   LISTEN      

tcp 有监听的
udp 没有监听的

不明白 Foreign Address

####netstat -an例子
Proto Recv-Q Send-Q Local Address               Foreign Address             State
tcp        0      0 ::ffff:192.168.0.103:22     ::ffff:192.168.0.105:1976   ESTABLISHED 
tcp        0      0 ::ffff:192.168.0.103:22     ::ffff:192.168.0.105:1976   ESTABLISHED 
tcp        0      0 ::ffff:192.168.0.103:22     ::ffff:192.168.0.105:1975   ESTABLISHED 

1976和1975表示连接计算机的端口（原端口）


ESTABLISHED （表示当前正在连接）

下面部分表示计算机程序所占用的端口
Active UNIX domain sockets (servers and established)
Proto RefCnt Flags       Type       State         I-Node Path

#挂载光盘
mount iso9660 /dev/sr0 /mnt/cdrom

umount /dev/sr0

#############vi的使用###############
a 光标所在字符后插入
A 光标所在行尾插入
i 光标所在字符前插入
I 光标所在行行首插入
o
O

set nonu

gg 到第一行
G 到最后一行
nG 到某行
或者在命令行输入行+回车()
$ 移至行尾
0 移至行首

x 删除光标所在字符
nx sha
dd 删除行
ndd 删除n行
dG 删除光标所有行到文件末尾内容
D 删除光标所在处到行尾内容
:n2,n2d 删除自动范围的行

复制和粘贴
yy 复制当前行


/要替换

/r /pathoffile (文件引过来)
:!shell command(不退出vi 执行shell)
:r !date (会把命令结果引过来)
2014年 11月 17日 星期一 20:55:24 CST


产生swp文件
用 vim -r filename 恢复


#######################软件包管理#############################
rpm -V 包名

rmp2cpio 包全名 

cpio 选项

rpm -qf /bin/ls (查找rpm输入哪个软件包)
coreutils-5.97-23.el5_4.2

rpm2cpio /mnt/cdro,m/Packages/coreutils-5.97-23.el5_4.2| cpio -idv ./bin/ls

cp /root/bin/ls /bin/

######yum在线管理####################
/etc/sysconfig/network-scripts/ifcfg-eth0
ONBOOT='NO' 改为
ONBOOT='yes'

网络yum源的地址为
/etc/yum.repos.d/CentOS-Base.repo

###例子
[base]
name=CentOS-$releasever - Base
mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os
#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-5

##说明
[base] 容器名称，一定要放在[]中
name 容器说明
mirrorlist 镜像站点，这个可以注释掉
baseurl 我们的yum源服务器的地址，默认是centos的官方yum源服务器， 可以改成自己喜欢的yum源地址
enabled 此容器是否生效，如果不写货写成enable=1都是生效的
gpgcheck 如果是1是指rpm的数字证书生效，如果是0，则不生效
gpgkey 数字证书的公钥文件保存的位置，不用修改

###yum命令
yum list （查询所有可用的软件包列表）
yum search 关键字 （搜索服务器上所有和关键字相关的包）
yum -y update 包名 （更新包） 慎用
yum -y remove 包名  慎用

###yum 软件组管理
yum grouplist
yum groupinstall 软件组名
yum groupremove 软件组名


####RPM包默认安装位置
/etc/ 		配置文件
/usr/bin/	可执行文件	
/usr/lib/	函数库
/usr/share/doc/	基本软件使用手册
/usr/share/man/ 帮助文件


###源码安装
./configure --help (查看所有的可以跟的参数)
make clean

####用户组###




#######文件系统

df 文件系统
-a 显示所有文件系统的信息，包括test文件系统 如 /proc /sysfs
-h 使用习惯单位显示容量
-T 显示文件系统类型
-m 以MB为单位显示容量
-k 以KB为单位显示容量


du (统计目录或者文件大小)
du -sh 
-a 显示每个文件磁盘占用量
-h 使用习惯单位显示磁盘的占用量
-s 统计总占用量，而不列出子目录和子文件的占用量

fsck 文件系统修复命令
-a 不用显示用户提示
-y 自动修复


dumpe2fs /dev/sda1(显示磁盘状态的)


############Linux支持NTFS文件系统的
ntf-3g 插件




#############文件系统管理########################

###fdisk使用
fdisk -l (查询系统识别的硬盘、列出全部的分区)

fdisk /dev/sdb

　[root@localhost beinan]# fdisk /dev/sda
　　Command (m for help): 在这里按m ，就会输出帮助；
　　Command action
　　a toggle a bootable flag
　　b edit bsd disklabel
　　c toggle the dos compatibility flag
　　d delete a partition 注：这是删除一个分区的动作；
　　l list known partition types 注：l是列出分区类型，以供我们设置相应分区的类型；
　　m print this menu 注：m 是列出帮助信息；
　　n add a new partition 注：添加一个分区；
　　o create a new empty DOS partition table
　　p print the partition table 注：p列出分区表；
　　q quit without saving changes 注：不保存退出；
　　s create a new empty Sun disklabel
　　t change a partition's system id 注：t 改变分区类型；
　　u change display/entry units
　　v verify the partition table
　　w write table to disk and exit 注：把分区表写入硬盘并退出；
　　x extra functionality (experts only) 注：扩展应用，专家功能；

###自动挂载
要写入/etc/fstab文件
dumpe2fs -h /dev/sda1 (查看新分区的设备文件名)

Filesystem volume name:   /boot
Last mounted on:          <not available>
Filesystem UUID:          045c6ab4-5c04-44f1-8361-534c02870d1f (为分区的设备文件名) 

/etc/fstab文件的内容
LABEL=/boot             /boot                   ext3    defaults        	1 2

UUID 分区的uuid（或名称） 挂载点		文件系统 自动挂载使用默认权限   | |
										| |
										| |
										| |
										| |
										| |
指定分区是否被dump备份（0代表不备份，1代表每天备份，2代表不定期备份）<<<--------| |------------->>>>>指定分区是否被fsck检测，0：不检测，其它数字代表检测优先级

lost+found （备份分区的内容）

用mount -a 命令 （根据/etc/fstab文件自动挂载一遍系统分区）

mount -o remount,rw / (将 / 挂载成读写)	


###########################shell编程##########################
linux支持的shell可以再/etc/shells中查看
在Linux各种shell切换可以用 入 sh csh 等等进行切换
/sbin/nologin

###shell执行方式#####
echo -e  支持反斜线特殊字符转义

转义字符如下
字符	意义
\\ 	插入\字符；
\a 	发出警告声；
\b 	退格符（删除前一个字符，向左删除键）
\c 	最后不加上换行符号（取消输出行末的换行符，和-n 选项一致）；
\e	ESCAPE键
\f	换页符
\n 	换行且光标移至行首
\r	回车键
\t	制表符
\v	垂直制表符
\0nnn	按照八进制ASCII码表输出字符。
\xhh	按照十六进制ASCII码表输出字符。


\e[1;	开启颜色输出
\e[0m	结束颜色输出
例如
echo -e "\e[1;31mabcd\e[0m";

30m=黑色，31m=红色，32m=绿色，33m=黄色
34m=蓝色，35m=洋红，36m=青色，37m=白色


cat -A 查看所有字符
#!/bin/bash$
#The first program$
echo -e "This is my first shell script!"$

###说明 linux中回车符是$
一些在windonw中编辑的shell回车是用ctrlM+$作为回车的所以要将windown的转成linux，要用到命令doc2unix
用法为 doc2unix /file
与之相对于的是unix2doc /file


#################shell的基本功能###############
##别名命令
alias 别名='原命令' #设置命令别名
alias 查询命令别名

/root/.bashrc (直接修改该文件，设置别名)

unalias 取消别名

base 常用快捷键

ctrl+A		把光标移动命令行开头
ctrl+E		把光标移动到命令行结尾
ctrl+C		强制终止当前命令
ctrl+L		清屏
ctrl+U		删除或剪切光标之前的命令
ctrl+K		删除或剪切光标之后的内容
ctrl+Y		粘贴ctru+U或ctrl+K的内容
ctrl+R		在历史命令中搜索
ctrl+D		退出当且的终端
ctrl+Z		暂停，并放入后台
ctrl+S		暂停屏幕输出
ctrl+Q		恢复屏幕输出

#####输入输出重定向#######
标准输入输出
设备		设备文件名	文件描述符	类型	
键盘		/dev/stdin	  0		标准输入
显示器		/dev/stdout	  1		标准输出
显示器		/dev/stderr	  2		标准错误输出

输出重定向
标准输出	命令>>文件
标准错误	错误命令 2 >>文件

例如故意输出错误 lst 2>>abc （没有lst命令错误信息定向到abc中）

正确输入和错误输出同城保存
命令> 文件 2>&1		 以覆盖方式，把正确输出和错误输出都保存到一个文件中
命令>>文件 2>&1		 以追加方式，把正确输出和错误输出都保存到一个文件中
命令 &>文件 		 以覆盖方式，把正确输出和错误输出都保存到一个文件中
命令 &>>文件		 以追加方式，把正确输出和错误输出都保存到一个文件中
命令>>文件1 2>>文件2	 把正确输出追加到文件1中，把错误输出追加到文件2中


wc 输入 按ctrl+D
统计
-c 统计字节数
-w 统计单词数
-l 统计行数

####多名利顺序执行与管道符
dd if=输入文件 of=输出文件 bs=字节数 count=个数
例如
date;dd if=/dev/zero of=/root/restfile bs=1k count=100000;date;

grep [选项] "搜索内容" 文件名
选项
-i		忽略大小写
-n		输出行数
-v		反向查找
--color=auto	搜索出的关键字用颜色显示

############通配符和其他特殊符号###########
通配符匹配文件名
`` 反引号是系统命令
$() 和反引号作用一样，用来引用系统命令
$ 调用变量值
\ 转义符

####用户自定义变量
aa 变量叠加如下
"$aa"789
${aa}789
用set查看系统的所有变量
unset name 取消变量

############环境变量############
用户自定义变量只在当前shell生效，环境变量会在当前shell和这个shell
所在shell中生效。如果环境变量写入相应配置文件，环境变量就会在所有的
shell中生效。

设置环境变量
export 变量名=变量值
例如
export age=18 (定义环境变量age)
sex=nan (定义一个自定义普通变量)
export sex (将定义好sex变量设置成环境变量)

env （查询环境变量）
set （查询所有的变量）
清空环境变量和普通变量一样用
unset

PS1 定义系统提示符的变量
\d	显示格式，格式为"星期 月 日"
\h	显示简写主机名。如默认主机名 "localhost"
\t	显示24小时制时间，格式为"HH:MM:SS"
\T	显示12小时制时间，格式为"HH:MM"
\A	显示24小时制时间，格式为"HH:MM"
\u	显示当前用户名
\w	显示当前所在目录的完整名称
\W	显示当前所有目录的最后一个目录
\#	执行的第几个命令
\$	提示符。如果root显示"#",普通用户显示"$"

##位置参数变量#####
$n	n为数字，$0代表命令本身，$1-$9代表第一个到第九个参数，十以上的参数用大括号，如${10}
$*	这个变量代表命令行所有的参数，$*把所有的参数看成一个整体
$@	这个参数也代表命令行所有参数，不过$@把每个参数区分对待
$#	这个变量代表命令行中所有参数的个数







父子进程用
pstree



#########预定义变量###########
$?	最后一次执行命令的返回状态,如果为0，证明上一个命令正确执行；如果为非0（具体是哪个数，由命令自己决定），证明上一个命令执行不正确
$$	当前进程的进程号
$!	后台运行的最后一个进程的进程号

###接收键盘输入
read [选项] [变量名]
选项
-p "提示信息" 在等待read输入时，输出提示信息
-t 秒数		read命令会一直等待用户输入，使用此选项可以指定等待时间
-n 字符数	read命令只接收指定的字符数，就会执行
-s		隐藏输入的数据，适用机密信息的输入

####数值运算与运算符###
decalre [+/-][选项]  变量名
选项
-	给变量设定类型属性
+	取消变量类型属性
-i	将变量声明为整数型
-x	将变量声明为环境变量
-p	显示指定变量的被声明的类型

declare -p PATH
declare -x PATH="/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/src/rabbitmq_server-3.3.4/sbin:/root/bin"

例如
aa=11
bb=22
若想计算aa和bb之和
可以用cc=$(($aa+bb))  cc=$[$aa+$bb]
或者用declare -i cc=$aa+$bb
或者用cc=$(expr $aa + $bb)  (注意+号左右两侧必须有空格);

##########变量测试与内容测试#############
-----------------------------------------------------------
变量置换方式  |	变量y没有设置 |	变量y为空   |	变量y设置值
-----------------------------------------------------------
x=${y-新值}   |	 x=新值	      |	 x为空	    |	 x=$y
-----------------------------------------------------------
x=${y:-新值}  |	 x=新值	      |	 x=新值	    |	 x=$y
-----------------------------------------------------------
x=${y+新值}   |	 x为空	      |	 x=新值	    |	 x=新值
-----------------------------------------------------------
x=${y:+新值}  |	 x为空	      |	 x为空	    |	 x=新值
-----------------------------------------------------------		 
x=${y=新值}   |	 x=新值       |  x为空      |  	 x=$y
	      |	 y=新值       |  y值不变    |    y值不变
-----------------------------------------------------------
x=${y:新值}   |	 x=新值	      |  x=新值     |    x=$y	
	      |	 y=新值       |  y=新值     |    y值不变
-----------------------------------------------------------
x=${y?新值}   | 新值输出到标准| x为空	    |	x=$y
	      |	错误输出(屏幕)|		    |
-----------------------------------------------------------
x=${y:?新值}  | 新值输出到标准| 新值输出到  |	x=$y
	      |	错误输出      | 标准错误输出|
-----------------------------------------------------------

#########环境变量配置文件###########
source 配置文件 或者 . 配置文件 （让配置文件直接生效）
环境变量文件
/etc/profile
/etc/profile.d/*.sh
~/.bash_profile	---|各个用户的家目录只对
~/.bashrc	---|这个用户有效
/etc/bashrc

/etc/profile------>~/bash_profile----------->/etc/bashrc------->命令提示符
   |						  |	
   |						  |	
   |						  |---------------定义的noligin shell (不输入用户名密码，在shell用用bash csh切换的情况)
   |----> /etc/profile.d/*.sh----------------------				
		  |
		  |
	     /etc/profile.d/lang.sh--------->/etc/syscconfig/I18n
	








































































